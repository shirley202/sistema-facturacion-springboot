<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Facturas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-4">

<h2>Facturas</h2>

<a th:href="@{/facturas/nueva}" class="btn btn-primary mb-3">
    Nueva Factura
</a>

<table class="table table-bordered table-striped">
    <thead class="table-dark">
    <tr>
        <th>ID</th>
        <th>NÃºmero</th>
        <th>Cliente</th>
        <th>Total</th>
        <th>Estado</th>
        <th>Acciones</th>
    </tr>
    </thead>

    <tbody>
    <tr th:each="factura : ${facturas}">
        <td th:text="${factura.id}"></td>
        <td th:text="${factura.numero}"></td>

        <td th:text="${factura.cliente != null ? factura.cliente.nombre : 'Sin Cliente'}">
        </td>

        <td th:text="${factura.totalGeneral}"></td>

        <td>
            <span th:if="${factura.estado != null and factura.estado.name() == 'BORRADOR'}"
                  class="badge bg-secondary">BORRADOR</span>

            <span th:if="${factura.estado != null and factura.estado.name() == 'EMITIDA'}"
                  class="badge bg-success">EMITIDA</span>

            <span th:if="${factura.estado != null and factura.estado.name() == 'ANULADA'}"
                  class="badge bg-danger">ANULADA</span>
        </td>

        <td>
            <a th:if="${factura.estado != null and factura.estado.name() == 'BORRADOR'}"
               th:href="@{/facturas/emitir/{id}(id=${factura.id})}"
               class="btn btn-success btn-sm">Emitir</a>

            <a th:if="${factura.estado != null and factura.estado.name() == 'EMITIDA'}"
               th:href="@{/facturas/anular/{id}(id=${factura.id})}"
               class="btn btn-danger btn-sm">Anular</a>

            <a th:if="${factura.estado != null and factura.estado.name() == 'EMITIDA'}"
               th:href="@{/facturas/xml/{id}(id=${factura.id})}"
               class="btn btn-info btn-sm">XML</a>
        </td>

    </tr>
    </tbody>
</table>

</body>
</html>